<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="Hide and seek"><!-- <meta property="og:title" content="Hide and Seek"> --><!-- <meta property="og:description" content="My description"> --><!-- <meta property="og:type" content="website"> --><!-- <meta property="og:image" content="https://via.placeholder.com/500"> --><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Monoton&display=fallback" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,400;0,700;1,900&display=fallback" rel="stylesheet"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><!-- <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"> --><!-- <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png"> --><title>Hide and Seek</title><style>a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}body{line-height:1}body{background-color:#fff;color:#333;font-family:Lato,Arial,Helvetica,sans-serif}a{color:inherit;text-decoration:none}a,button,input{font-family:Lato,Arial,Helvetica,sans-serif}button{background-color:#222;border:none;border-radius:2px;color:#fff;cursor:pointer;font-size:21px;padding:15px;width:100%}button:active{border:1px solid #333;color:#333;outline:1px solid #333}button:focus{border:1px solid #333;color:#333;outline:1px solid #333}input{box-sizing:border-box;font-family:Lato,Arial,Helvetica,sans-serif;font-size:30px;font-weight:400;margin-bottom:40px;width:100%}label{font-family:Lato,Arial,Helvetica,sans-serif;font-size:21px;font-weight:200}.hidden{display:none!important}.hide{display:none!important}.invisible{visibility:hidden}.spacer{border-bottom:1px dashed #777;margin:10px 0}.page-wrapper{margin:0 auto;max-width:1000px;padding:10px 30px}.button-wrapper{text-align:center;padding:10px 0}.container{padding-bottom:30px}.room-code{text-transform:uppercase}.bold{font-weight:700}.bold.link{font-weight:700;padding:10px 0}.reflect{-webkit-box-reflect:below 0 -webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(70%,transparent),to(rgba(250,250,250,.1)))}.header{width:100vw;text-align:center;background-color:#222;color:#fff;font-weight:200;padding:10px 0}.header h1{color:#fff;font-family:Monoton,cursive;font-size:24px;font-weight:400;letter-spacing:2px;text-shadow:1px 2px #000;text-transform:uppercase}[data-screen=landing]{max-width:420px;margin:0 auto}[data-screen=landing] [data-input=room-code]{text-transform:uppercase}[data-screen=landing] button{color:#ff0;font-family:Monoton,cursive;font-weight:400;letter-spacing:2px;text-shadow:1px 2px #000;text-transform:uppercase}[data-screen=landing] .game-name{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=lobby]{font-size:20px;max-width:420px;margin:0 auto}[data-screen=lobby] button{max-width:250px}[data-screen=lobby] .game-info{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=lobby] .game-name{padding-bottom:10px}[data-group=host] [data-screen=lobby]{max-width:1000px;margin:0 auto}[data-group=host] [data-screen=lobby] .crate-wrapper{position:relative;height:100px;margin-bottom:40px}[data-group=host] [data-screen=lobby] .crate{background-image:url(images/crate.svg);background-size:cover;height:100px;width:100px}[data-group=host] [data-screen=lobby] .player-name{position:absolute;position:absolute;bottom:10px;left:110px}[data-group=host] [data-screen=lobby] .waiting{text-align:center;padding:30px 0;text-transform:uppercase}[data-group=player] [data-screen=lobby] .section-title{text-align:center;border-bottom:1px dotted #333}[data-group=player] [data-screen=lobby] .player-list .player{padding:10px;border-bottom:1px dotted #ccc}[data-group=player] [data-screen=lobby] .player-list .player .crate{display:inline-block;width:30px;height:30px;vertical-align:middle;background-image:url(images/crate.svg);background-size:cover}[data-group=player] [data-screen=lobby] .player-list .player .player-name{padding-left:10px}[data-group=player] [data-screen=lobby] .menu{margin-bottom:20px}[data-group=player] [data-screen=lobby] .menu table{margin:0 auto;border-collapse:collapse}[data-group=player] [data-screen=lobby] .menu td{width:100px;height:54px;border:1px solid #ccc}[data-group=player] [data-screen=lobby] .menu button{width:100%;height:100%;background-color:transparent;background-image:url(images/horse_still_frame.png);background-size:contain;background-repeat:no-repeat;background-position:center}.dice{padding:4px;background-color:#333;width:104px;height:104px;border-radius:10%;margin-right:10px}.dot{display:block;width:24px;height:24px;border-radius:50%;background-color:#fff}.first-face{display:flex;justify-content:center;align-items:center}.second-face{display:flex;justify-content:space-between}.second-face .dot:nth-of-type(2){align-self:flex-end}.third-face{display:flex;justify-content:space-between}.third-face .dot:nth-of-type(1){align-self:flex-end}.third-face .dot:nth-of-type(2){align-self:center}.fifth-face,.fourth-face,.sixth-face{display:flex;justify-content:space-between}.fifth-face .column,.fourth-face .column,.sixth-face .column{display:flex;flex-direction:column;justify-content:space-between}.fifth-face .column:nth-of-type(2){justify-content:center}[data-screen=game]{max-width:1000px;margin:0 auto}[data-screen=game] .game-info{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=game] .game-name{padding-bottom:10px}[data-screen=game] .crates{width:300px;margin:0 auto;margin-bottom:20px}[data-screen=game] .crates [data-crates]{display:grid;grid-template-columns:repeat(5,1fr);justify-items:center;justify-content:center;grid-template-rows:repeat(5,60px);align-items:center}[data-screen=game] .crate{background-image:url(images/crate.svg);width:40px;height:40px;background-size:cover}[data-screen=game] .crate.selected{border:3px solid gold}[data-screen=game] .crate.open{opacity:.3}[data-screen=game] .play-again{padding-top:20px;text-align:center}[data-screen=game] .play-again button{max-width:200px;text-transform:capitalize}[data-screen=game] .player-list{border-top:1px dashed #999;margin:0 auto;padding-top:30px;width:320px}[data-screen=game] .player-list .player{padding:10px;border-bottom:1px dotted #ccc}[data-screen=game] .player-list .player .player-name{font-weight:700}[data-group=player] [data-screen=game] .treasure-wrapper{display:grid;grid-template-columns:repeat(5,1fr);justify-items:center;justify-content:center;grid-template-rows:repeat(1,60px);align-items:center;width:300px;margin:0 auto}[data-screen=game] .treasure{background-image:url(images/gold.svg);width:40px;height:40px;background-size:cover}[data-screen=game] .player-list .treasure{margin-left:15px;display:inline-block;vertical-align:middle}[data-screen=game] .narrative{width:320px;margin:0 auto;text-align:center;line-height:24px}[data-group=player] [data-screen=game] .commit-wrapper{text-align:center;margin-top:30px;margin-bottom:30px}[data-group=player] [data-screen=game] .commit-wrapper button{color:gold;width:300px}</style></head><body><div class="header"><h1>tipsy.games</h1></div><div class="page-wrapper"><div class="container" data-screen="landing"><div class="game-name">Hide and Seek</div><div><label>Room Code</label><input data-input="room-code" type="text" placeholder="AAAA"></div><div><label>Player Name</label><input data-input="player-name" type="text" placeholder="guest"></div><div class="button-wrapper"><button data-action="joinGame">Join Game</button></div><div class="spacer"></div><div class="button-wrapper"><button data-action="newGame">New Game</button></div></div><div data-group="host"><div class="container hidden" data-screen="lobby"><div data-group="host"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="room-code bold"></div></div></div><div class="crates"></div><div class="waiting">waiting for players to join</div><div class="start-game-wrapper"><div class="button-wrapper hide"><button data-action="startGame">Start Game</button></div></div></div></div><div class="container hidden" data-screen="game"><div data-group="host"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="broadcast bold hide">Start Hiding</div></div></div><div class="crates"></div><div class="narrative"></div><div class="player-list"></div><div class="play-again hide"><button data-action="playAgain">play again</button></div></div></div></div><div data-group="player"><div class="container hidden" data-screen="lobby"><div data-group="player"><div class="game-info"><div class="game-name">Hide and Seek</div><div class="room-code bold"></div></div><div><div class="section-title">Player List</div><div class="player-list"></div></div></div></div><div class="container hidden" data-screen="game"><div data-group="player"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="broadcast bold"></div></div></div><div class="treasure-wrapper"></div><div class="crates"></div><div class="narrative"></div><div class="commit-wrapper hide"><button data-action="commit">commit</button></div><div class="player-list"></div></div></div></div></div><script>!function(){"use strict";const e=[],t=()=>{e.push(...arguments)},n=()=>{window.console.log(e.join("\n"))},r={displayLog:n,store:{}};function o(){return r.ref}let a=!0;async function s(){if(console.log("commit treasure"),!a)return;a=!1;document.querySelector('[data-screen="game"] .game-info .broadcast').innerHTML="Your treasure is hidden";document.querySelector('[data-screen="game"] .treasure-wrapper').classList.add("hide");document.querySelector('[data-screen="game"] .commit-wrapper').classList.add("hide");const e=c();console.log("indexes",e);const t=o(),{playerKey:n}=r;await t.child("game/players/"+n).update({indexes:e,treasure:3}).then(()=>{console.log("indexes are set:",e),a=!0})}function c(){const e=document.querySelectorAll(".crate.selected"),t=[];return e.forEach(e=>{t.push(e.dataset.index)}),t.join(",")}function i(e){console.log("display screen:",e),document.querySelectorAll("[data-screen]").forEach(e=>{e.classList.add("hidden")}),document.querySelector(`[data-screen="${e}"]`).classList.remove("hidden"),window.app.screen=e}function u(){console.log("render the lobby");const{code:e,playerList:t}=r;e&&f(e),d(t),l(t,2),console.log("beginning to render the lobby")}function l(e,t){const n=Object.keys(e).length,r=document.querySelector('[data-screen="lobby"] button[data-action="startGame"]').parentNode;n<t?r.classList.add("hide"):r.classList.remove("hide")}function d(e){console.log("update player list",e);let t=Object.keys(e).map(t=>{const{playerName:n}=e[t];return`<div class="crate-wrapper"><div class="crate reflect"></div><div class="player-name">${n}</div></div>`}).join("");document.querySelector('[data-screen="lobby"] .crates').innerHTML=t}function f(e){document.querySelector('[data-screen="lobby"] .room-code').innerText=e}var p="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,g=p||y||Function("return this")(),h=g.Symbol,v=Object.prototype,m=v.hasOwnProperty,b=v.toString,_=h?h.toStringTag:void 0;function j(e){var t=m.call(e,_),n=e[_];try{e[_]=void 0;var r=!0}catch(e){}var o=b.call(e);return r&&(t?e[_]=n:delete e[_]),o}var w=Object.prototype,O=w.toString;function S(e){return O.call(e)}var L="[object Null]",x="[object Undefined]",$=h?h.toStringTag:void 0;function T(e){return null==e?void 0===e?x:L:$&&$ in Object(e)?j(e):S(e)}function k(e){return null!=e&&"object"==typeof e}var A="[object Symbol]";function q(e){return"symbol"==typeof e||k(e)&&T(e)==A}function M(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}var z=Array.isArray,N=1/0,E=h?h.prototype:void 0,H=E?E.toString:void 0;function P(e){if("string"==typeof e)return e;if(z(e))return M(e,P)+"";if(q(e))return H?H.call(e):"";var t=e+"";return"0"==t&&1/e==-N?"-0":t}function C(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function R(e){return e}var D="[object AsyncFunction]",U="[object Function]",I="[object GeneratorFunction]",F="[object Proxy]";function B(e){if(!C(e))return!1;var t=T(e);return t==U||t==I||t==D||t==F}var G,J=g["__core-js_shared__"],W=(G=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"";function K(e){return!!W&&W in e}var V=Function.prototype,Y=V.toString;function Q(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var X=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,ee=Function.prototype,te=Object.prototype,ne=ee.toString,re=te.hasOwnProperty,oe=RegExp("^"+ne.call(re).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ae(e){return!(!C(e)||K(e))&&(B(e)?oe:Z).test(Q(e))}function se(e,t){return null==e?void 0:e[t]}function ce(e,t){var n=se(e,t);return ae(n)?n:void 0}var ie=ce(g,"WeakMap");function ue(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function le(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var de=800,fe=16,pe=Date.now;function ye(e){var t=0,n=0;return function(){var r=pe(),o=fe-(r-n);if(n=r,o>0){if(++t>=de)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function ge(e){return function(){return e}}var he=function(){try{var e=ce(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ve=he?function(e,t){return he(e,"toString",{configurable:!0,enumerable:!1,value:ge(t),writable:!0})}:R,me=ye(ve);function be(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}function _e(e){return e!=e}function je(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function we(e,t,n){return t==t?je(e,t,n):be(e,_e,n)}function Oe(e,t){return!!(null==e?0:e.length)&&we(e,t,0)>-1}var Se=9007199254740991,Le=/^(?:0|[1-9]\d*)$/;function xe(e,t){var n=typeof e;return!!(t=null==t?Se:t)&&("number"==n||"symbol"!=n&&Le.test(e))&&e>-1&&e%1==0&&e<t}function $e(e,t,n){"__proto__"==t&&he?he(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Te(e,t){return e===t||e!=e&&t!=t}var ke=Object.prototype,Ae=ke.hasOwnProperty;function qe(e,t,n){var r=e[t];Ae.call(e,t)&&Te(r,n)&&(void 0!==n||t in e)||$e(e,t,n)}var Me=Math.max;function ze(e,t,n){return t=Me(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=Me(r.length-t,0),s=Array(a);++o<a;)s[o]=r[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=r[o];return c[t]=n(s),ue(e,this,c)}}function Ne(e,t){return me(ze(e,t,R),e+"")}var Ee=9007199254740991;function He(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ee}function Pe(e){return null!=e&&He(e.length)&&!B(e)}var Ce=Object.prototype;function Re(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ce)}function De(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ue="[object Arguments]";function Ie(e){return k(e)&&T(e)==Ue}var Fe=Object.prototype,Be=Fe.hasOwnProperty,Ge=Fe.propertyIsEnumerable,Je=Ie(function(){return arguments}())?Ie:function(e){return k(e)&&Be.call(e,"callee")&&!Ge.call(e,"callee")};function We(){return!1}var Ke="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ve=Ke&&"object"==typeof module&&module&&!module.nodeType&&module,Ye=Ve&&Ve.exports===Ke,Qe=Ye?g.Buffer:void 0,Xe=Qe?Qe.isBuffer:void 0,Ze=Xe||We,et="[object Arguments]",tt="[object Array]",nt="[object Boolean]",rt="[object Date]",ot="[object Error]",at="[object Function]",st="[object Map]",ct="[object Number]",it="[object Object]",ut="[object RegExp]",lt="[object Set]",dt="[object String]",ft="[object WeakMap]",pt="[object ArrayBuffer]",yt="[object DataView]",gt="[object Float32Array]",ht="[object Float64Array]",vt="[object Int8Array]",mt="[object Int16Array]",bt="[object Int32Array]",_t="[object Uint8Array]",jt="[object Uint8ClampedArray]",wt="[object Uint16Array]",Ot="[object Uint32Array]",St={};function Lt(e){return k(e)&&He(e.length)&&!!St[T(e)]}function xt(e){return function(t){return e(t)}}St[gt]=St[ht]=St[vt]=St[mt]=St[bt]=St[_t]=St[jt]=St[wt]=St[Ot]=!0,St[et]=St[tt]=St[pt]=St[nt]=St[yt]=St[rt]=St[ot]=St[at]=St[st]=St[ct]=St[it]=St[ut]=St[lt]=St[dt]=St[ft]=!1;var $t="object"==typeof exports&&exports&&!exports.nodeType&&exports,Tt=$t&&"object"==typeof module&&module&&!module.nodeType&&module,kt=Tt&&Tt.exports===$t,At=kt&&p.process,qt=function(){try{var e=Tt&&Tt.require&&Tt.require("util").types;return e||At&&At.binding&&At.binding("util")}catch(e){}}(),Mt=qt&&qt.isTypedArray,zt=Mt?xt(Mt):Lt,Nt=Object.prototype,Et=Nt.hasOwnProperty;function Ht(e,t){var n=z(e),r=!n&&Je(e),o=!n&&!r&&Ze(e),a=!n&&!r&&!o&&zt(e),s=n||r||o||a,c=s?De(e.length,String):[],i=c.length;for(var u in e)!t&&!Et.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||xe(u,i))||c.push(u);return c}function Pt(e,t){return function(n){return e(t(n))}}var Ct=Pt(Object.keys,Object),Rt=Object.prototype,Dt=Rt.hasOwnProperty;function Ut(e){if(!Re(e))return Ct(e);var t=[];for(var n in Object(e))Dt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function It(e){return Pe(e)?Ht(e):Ut(e)}var Ft=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bt=/^\w*$/;function Gt(e,t){if(z(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!q(e))||(Bt.test(e)||!Ft.test(e)||null!=t&&e in Object(t))}var Jt=ce(Object,"create");function Wt(){this.__data__=Jt?Jt(null):{},this.size=0}function Kt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Vt="__lodash_hash_undefined__",Yt=Object.prototype,Qt=Yt.hasOwnProperty;function Xt(e){var t=this.__data__;if(Jt){var n=t[e];return n===Vt?void 0:n}return Qt.call(t,e)?t[e]:void 0}var Zt=Object.prototype,en=Zt.hasOwnProperty;function tn(e){var t=this.__data__;return Jt?void 0!==t[e]:en.call(t,e)}var nn="__lodash_hash_undefined__";function rn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Jt&&void 0===t?nn:t,this}function on(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function an(){this.__data__=[],this.size=0}function sn(e,t){for(var n=e.length;n--;)if(Te(e[n][0],t))return n;return-1}on.prototype.clear=Wt,on.prototype.delete=Kt,on.prototype.get=Xt,on.prototype.has=tn,on.prototype.set=rn;var cn=Array.prototype,un=cn.splice;function ln(e){var t=this.__data__,n=sn(t,e);return!(n<0)&&(n==t.length-1?t.pop():un.call(t,n,1),--this.size,!0)}function dn(e){var t=this.__data__,n=sn(t,e);return n<0?void 0:t[n][1]}function fn(e){return sn(this.__data__,e)>-1}function pn(e,t){var n=this.__data__,r=sn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}yn.prototype.clear=an,yn.prototype.delete=ln,yn.prototype.get=dn,yn.prototype.has=fn,yn.prototype.set=pn;var gn=ce(g,"Map");function hn(){this.size=0,this.__data__={hash:new on,map:new(gn||yn),string:new on}}function vn(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function mn(e,t){var n=e.__data__;return vn(t)?n["string"==typeof t?"string":"hash"]:n.map}function bn(e){var t=mn(this,e).delete(e);return this.size-=t?1:0,t}function _n(e){return mn(this,e).get(e)}function jn(e){return mn(this,e).has(e)}function wn(e,t){var n=mn(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function On(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}On.prototype.clear=hn,On.prototype.delete=bn,On.prototype.get=_n,On.prototype.has=jn,On.prototype.set=wn;var Sn="Expected a function";function Ln(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Sn);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=e.apply(this,r);return n.cache=a.set(o,s)||a,s};return n.cache=new(Ln.Cache||On),n}Ln.Cache=On;var xn=500;function $n(e){var t=Ln(e,(function(e){return n.size===xn&&n.clear(),e})),n=t.cache;return t}var Tn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kn=/\\(\\)?/g,An=$n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Tn,(function(e,n,r,o){t.push(r?o.replace(kn,"$1"):n||e)})),t}));function qn(e){return null==e?"":P(e)}function Mn(e,t){return z(e)?e:Gt(e,t)?[e]:An(qn(e))}var zn=1/0;function Nn(e){if("string"==typeof e||q(e))return e;var t=e+"";return"0"==t&&1/e==-zn?"-0":t}function En(e,t){for(var n=0,r=(t=Mn(t,e)).length;null!=e&&n<r;)e=e[Nn(t[n++])];return n&&n==r?e:void 0}function Hn(e,t,n){var r=null==e?void 0:En(e,t);return void 0===r?n:r}function Pn(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function Cn(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a}function Rn(){this.__data__=new yn,this.size=0}function Dn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Un(e){return this.__data__.get(e)}function In(e){return this.__data__.has(e)}var Fn=200;function Bn(e,t){var n=this.__data__;if(n instanceof yn){var r=n.__data__;if(!gn||r.length<Fn-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new On(r)}return n.set(e,t),this.size=n.size,this}function Gn(e){var t=this.__data__=new yn(e);this.size=t.size}function Jn(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var s=e[n];t(s,n,e)&&(a[o++]=s)}return a}function Wn(){return[]}Gn.prototype.clear=Rn,Gn.prototype.delete=Dn,Gn.prototype.get=Un,Gn.prototype.has=In,Gn.prototype.set=Bn;var Kn=Object.prototype,Vn=Kn.propertyIsEnumerable,Yn=Object.getOwnPropertySymbols,Qn=Yn?function(e){return null==e?[]:(e=Object(e),Jn(Yn(e),(function(t){return Vn.call(e,t)})))}:Wn;function Xn(e,t,n){var r=t(e);return z(e)?r:Pn(r,n(e))}function Zn(e){return Xn(e,It,Qn)}var er=ce(g,"DataView"),tr=ce(g,"Promise"),nr=ce(g,"Set"),rr="[object Map]",or="[object Object]",ar="[object Promise]",sr="[object Set]",cr="[object WeakMap]",ir="[object DataView]",ur=Q(er),lr=Q(gn),dr=Q(tr),fr=Q(nr),pr=Q(ie),yr=T;(er&&yr(new er(new ArrayBuffer(1)))!=ir||gn&&yr(new gn)!=rr||tr&&yr(tr.resolve())!=ar||nr&&yr(new nr)!=sr||ie&&yr(new ie)!=cr)&&(yr=function(e){var t=T(e),n=t==or?e.constructor:void 0,r=n?Q(n):"";if(r)switch(r){case ur:return ir;case lr:return rr;case dr:return ar;case fr:return sr;case pr:return cr}return t});var gr=yr,hr=g.Uint8Array,vr="__lodash_hash_undefined__";function mr(e){return this.__data__.set(e,vr),this}function br(e){return this.__data__.has(e)}function _r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new On;++t<n;)this.add(e[t])}function jr(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function wr(e,t){return e.has(t)}_r.prototype.add=_r.prototype.push=mr,_r.prototype.has=br;var Or=1,Sr=2;function Lr(e,t,n,r,o,a){var s=n&Or,c=e.length,i=t.length;if(c!=i&&!(s&&i>c))return!1;var u=a.get(e),l=a.get(t);if(u&&l)return u==t&&l==e;var d=-1,f=!0,p=n&Sr?new _r:void 0;for(a.set(e,t),a.set(t,e);++d<c;){var y=e[d],g=t[d];if(r)var h=s?r(g,y,d,t,e,a):r(y,g,d,e,t,a);if(void 0!==h){if(h)continue;f=!1;break}if(p){if(!jr(t,(function(e,t){if(!wr(p,t)&&(y===e||o(y,e,n,r,a)))return p.push(t)}))){f=!1;break}}else if(y!==g&&!o(y,g,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function xr(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function $r(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Tr=1,kr=2,Ar="[object Boolean]",qr="[object Date]",Mr="[object Error]",zr="[object Map]",Nr="[object Number]",Er="[object RegExp]",Hr="[object Set]",Pr="[object String]",Cr="[object Symbol]",Rr="[object ArrayBuffer]",Dr="[object DataView]",Ur=h?h.prototype:void 0,Ir=Ur?Ur.valueOf:void 0;function Fr(e,t,n,r,o,a,s){switch(n){case Dr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Rr:return!(e.byteLength!=t.byteLength||!a(new hr(e),new hr(t)));case Ar:case qr:case Nr:return Te(+e,+t);case Mr:return e.name==t.name&&e.message==t.message;case Er:case Pr:return e==t+"";case zr:var c=xr;case Hr:var i=r&Tr;if(c||(c=$r),e.size!=t.size&&!i)return!1;var u=s.get(e);if(u)return u==t;r|=kr,s.set(e,t);var l=Lr(c(e),c(t),r,o,a,s);return s.delete(e),l;case Cr:if(Ir)return Ir.call(e)==Ir.call(t)}return!1}var Br=1,Gr=Object.prototype,Jr=Gr.hasOwnProperty;function Wr(e,t,n,r,o,a){var s=n&Br,c=Zn(e),i=c.length;if(i!=Zn(t).length&&!s)return!1;for(var u=i;u--;){var l=c[u];if(!(s?l in t:Jr.call(t,l)))return!1}var d=a.get(e),f=a.get(t);if(d&&f)return d==t&&f==e;var p=!0;a.set(e,t),a.set(t,e);for(var y=s;++u<i;){var g=e[l=c[u]],h=t[l];if(r)var v=s?r(h,g,l,t,e,a):r(g,h,l,e,t,a);if(!(void 0===v?g===h||o(g,h,n,r,a):v)){p=!1;break}y||(y="constructor"==l)}if(p&&!y){var m=e.constructor,b=t.constructor;m==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b||(p=!1)}return a.delete(e),a.delete(t),p}var Kr=1,Vr="[object Arguments]",Yr="[object Array]",Qr="[object Object]",Xr=Object.prototype,Zr=Xr.hasOwnProperty;function eo(e,t,n,r,o,a){var s=z(e),c=z(t),i=s?Yr:gr(e),u=c?Yr:gr(t),l=(i=i==Vr?Qr:i)==Qr,d=(u=u==Vr?Qr:u)==Qr,f=i==u;if(f&&Ze(e)){if(!Ze(t))return!1;s=!0,l=!1}if(f&&!l)return a||(a=new Gn),s||zt(e)?Lr(e,t,n,r,o,a):Fr(e,t,i,n,r,o,a);if(!(n&Kr)){var p=l&&Zr.call(e,"__wrapped__"),y=d&&Zr.call(t,"__wrapped__");if(p||y){var g=p?e.value():e,h=y?t.value():t;return a||(a=new Gn),o(g,h,n,r,a)}}return!!f&&(a||(a=new Gn),Wr(e,t,n,r,o,a))}function to(e,t,n,r,o){return e===t||(null==e||null==t||!k(e)&&!k(t)?e!=e&&t!=t:eo(e,t,n,r,to,o))}var no=1,ro=2;function oo(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Object(e);o--;){var c=n[o];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){var i=(c=n[o])[0],u=e[i],l=c[1];if(s&&c[2]){if(void 0===u&&!(i in e))return!1}else{var d=new Gn;if(r)var f=r(u,l,i,e,t,d);if(!(void 0===f?to(l,u,no|ro,r,d):f))return!1}}return!0}function ao(e){return e==e&&!C(e)}function so(e){for(var t=It(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,ao(o)]}return t}function co(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function io(e){var t=so(e);return 1==t.length&&t[0][2]?co(t[0][0],t[0][1]):function(n){return n===e||oo(n,e,t)}}function uo(e,t){return null!=e&&t in Object(e)}function lo(e,t,n){for(var r=-1,o=(t=Mn(t,e)).length,a=!1;++r<o;){var s=Nn(t[r]);if(!(a=null!=e&&n(e,s)))break;e=e[s]}return a||++r!=o?a:!!(o=null==e?0:e.length)&&He(o)&&xe(s,o)&&(z(e)||Je(e))}function fo(e,t){return null!=e&&lo(e,t,uo)}var po=1,yo=2;function go(e,t){return Gt(e)&&ao(t)?co(Nn(e),t):function(n){var r=Hn(n,e);return void 0===r&&r===t?fo(n,e):to(t,r,po|yo)}}function ho(e){return function(t){return null==t?void 0:t[e]}}function vo(e){return function(t){return En(t,e)}}function mo(e){return Gt(e)?ho(Nn(e)):vo(e)}function bo(e){return"function"==typeof e?e:null==e?R:"object"==typeof e?z(e)?go(e[0],e[1]):io(e):mo(e)}function _o(e){return k(e)&&Pe(e)}function jo(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function wo(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function Oo(e,t){return M(t,(function(t){return e[t]}))}function So(e){return null==e?[]:Oo(e,It(e))}var Lo=Math.min;function xo(e,t,n){for(var r=n?jo:Oe,o=e[0].length,a=e.length,s=a,c=Array(a),i=1/0,u=[];s--;){var l=e[s];s&&t&&(l=M(l,xt(t))),i=Lo(l.length,i),c[s]=!n&&(t||o>=120&&l.length>=120)?new _r(s&&l):void 0}l=e[0];var d=-1,f=c[0];e:for(;++d<o&&u.length<i;){var p=l[d],y=t?t(p):p;if(p=n||0!==p?p:0,!(f?wr(f,y):r(u,y,n))){for(s=a;--s;){var g=c[s];if(!(g?wr(g,y):r(e[s],y,n)))continue e}f&&f.push(y),u.push(p)}}return u}function $o(e){return _o(e)?e:[]}var To=Ne((function(e){var t=M(e,$o);return t.length&&t[0]===e[0]?xo(t):[]}));function ko(e,t){return t.length<2?e:En(e,Cn(t,0,-1))}function Ao(e,t){return null==(e=ko(e,t=Mn(t,e)))||delete e[Nn(wo(t))]}function qo(e,t,n,r){if(!C(e))return e;for(var o=-1,a=(t=Mn(t,e)).length,s=a-1,c=e;null!=c&&++o<a;){var i=Nn(t[o]),u=n;if("__proto__"===i||"constructor"===i||"prototype"===i)return e;if(o!=s){var l=c[i];void 0===(u=r?r(l,i,c):void 0)&&(u=C(l)?l:xe(t[o+1])?[]:{})}qe(c,i,u),c=c[i]}return e}var Mo=Array.prototype,zo=Mo.splice;function No(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==a){var a=o;xe(o)?zo.call(e,o,1):Ao(e,o)}}return e}var Eo=Math.floor,Ho=Math.random;function Po(e,t){return e+Eo(Ho()*(t-e+1))}function Co(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],a=e.length;for(t=bo(t);++r<a;){var s=e[r];t(s,r,e)&&(n.push(s),o.push(r))}return No(e,o),n}function Ro(e,t){var n=-1,r=e.length,o=r-1;for(t=void 0===t?r:t;++n<t;){var a=Po(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}function Do(e,t,n){return null==e?e:qo(e,t,n)}function Uo(e){return Ro(le(e))}function Io(e){return Ro(So(e))}function Fo(e){return(z(e)?Uo:Io)(e)}function Bo(){const{hider:e}=Hn(window,"app.game.round")||{},{indexes:t,guesses:n=""}=Hn(r,"game.players."+e)||{};return To(t.split(","),n.split(",")).length<3?(console.log("has treasure"),!0):(console.log("does not have treasure"),!1)}function Go(){return Hn(r,"game.round")}function Jo(e){let t=e.map((e,t)=>0===e?`<div class="crate" data-action="selectCrate" data-index="${t}"></div>`:1===e?'<div class="crate open"></div>':2===e?'<div class="treasure"></div>':void 0).join("");r.dom.$crates.innerHTML=`<div data-crates="default">${t}</div>`}function Wo(){let e=[];return e.length=25,e.fill(0),e}function Ko(e){console.log("getGridArrayFromPlayer",e);const t=Wo(),{indexes:n,guesses:o}=Hn(r,"game.players."+e)||{};if(o){const e=n.split(",");console.log("indexesArray",e),o.split(",").forEach(n=>{const r=Number(n);console.log("guess index:",r),t[r]=1,e.includes(r.toString())&&(t[r]=2)})}return t}function Vo(){const{playerList:e}=r||{};console.log("update player list",e);let t=Object.keys(e).map(e=>{const{playerName:t}=Hn(r,"playerList."+e)||"undefined",{treasure:n}=Hn(r,"game.players."+e)||0;return`<div class="player" data-key=${e}><div class="player-name">${t}</div>${'<div class="treasure"></div>'.repeat(n)}</div>`}).join("");r.dom.$playerList=document.querySelector('[data-screen="game"] .player-list'),r.dom.$playerList.innerHTML=t}function Yo(){console.log("render game");const{state:e}=Hn(r,"game.round")||"";return"winner"===e?(Xo(),void Qo()):r.game?(Vo(),void(Go()?(console.log("can update round"),Xo()):(console.log("can not update round"),console.log("isReadyToStartRound:",ta()),ta()&&(console.log("ready to start the round"),na())))):(r.initial_markup||(r.initial_markup=document.querySelector('[data-screen="game"]').innerHTML),sa(),void Vo())}function Qo(){console.log("render end game");const{dom:e}=r;e.$broadcast.innerHTML="tally up your treasure",e.$narrative.classList.add("hide"),e.$playAgain.classList.remove("hide")}function Xo(){if(console.log("update round"),!Bo())return console.log("no treasure"),void Zo();const{hider:e,seeker:t,guesses:n}=Hn(r,"game.round")||{};console.log("hider:",e),console.log("seeker:",t),console.log("guesses:",n);const{playerList:o}=r||{};console.log("playerList:",o);const{dom:a}=r;a.$broadcast.innerHTML=`<div>${o[t].playerName} is seeking</div>`,a.$narrative.innerHTML=`<div>${o[e].playerName} has treasure hidden here</div>`,Jo(Ko(e)),n||(console.log("Out of guesses, rotate to next player"),Zo())}async function Zo(){console.log("END TURN");const{round:e,players:t}=r.game||{};let n=e.seekers.split(",");1===n.length?n=Fo(Object.keys(t)):n.shift();const a=n[0],s=aa();console.log("remaining boards:",s);let c=Hn(r,"local.hiders")||[];Co(c,e=>e===a),c.length<1&&(console.log("no hiders found"),c=s);const i=Object.keys(t).length;if(1===s.length)return console.log("all treasure found"),void ea();const u=c.filter(e=>e!==a);console.log("total players: ",i),console.log("filtered boards: ",u);const l=Fo(u)[0];Co(c,e=>e===l);const d={guesses:3,hider:l,seeker:a,seekers:n.join(",")},f=o();await f.child("game/round").update(d).then(()=>{console.log("updated the round")})}async function ea(){console.log("BROADCAST WINNER");const e=o();await e.child("game/round").update({state:"winner"}).then(()=>{console.log("display the leaderboard")})}function ta(){if(!r.game)return!1;return Object.keys(r.playerList).length===Object.keys(r.game.players).length}async function na(){console.log("START ROUND");const e=oa();Do(r,"local.hiders",e),console.log("hiders:",e);const t=ra();console.log("seekers:",t);const n=t[0];console.log("seeker:",n);const a=Fo(e.filter(e=>e!==n))[0];console.log("hider:",n);const s={guesses:3,hider:a,seeker:n,seekers:t.join(",")},c=o();await c.child("game/round").update(s).then(()=>{console.log("started the round")})}function ra(){const{players:e}=r.game||{};return Fo(Object.keys(e))}function oa(){console.log("getHiders()");const e=Hn(r,"local.hiders")||aa();return console.log("hiders",e),Fo(e)}function aa(){console.log("get remaining boards");const{players:e}=r.game||{},t=[];for(const n in e){const{guesses:r="",indexes:o=""}=e[n],a=r.split(","),s=o.split(",");To(s,a).length<3?(console.log("treasure remains",n),t.push(n)):console.log("no treasure remains",n)}return t}async function sa(){console.log("newGame()"),document.querySelector('[data-screen="game"]').innerHTML=r.initial_markup;const e={};r.dom=e,e.$crates=document.querySelector('[data-screen="game"] .crates'),e.$broadcast=document.querySelector('[data-screen="game"] .broadcast'),e.$narrative=document.querySelector('[data-screen="game"] .narrative'),e.$playAgain=document.querySelector('[data-screen="game"] .play-again'),e.$broadcast.innerHTML="Time to hide your treasure",e.$broadcast.classList.remove("hide"),Jo(Wo())}const ca={game:Yo,lobby:u};function ia(){console.log("render the lobby");const{code:e,playerList:t}=r;e&&la(e),t&&ua(t),console.log("beginning to render the lobby")}function ua(e){console.log("update player list",e);document.querySelector('[data-screen="lobby"] .player-list').innerHTML=Object.keys(e).map(t=>`<div class="player"><div class="crate"></div><span class="player-name">${e[t].playerName}</span></div>`).join("")}function la(e){document.querySelector('[data-screen="lobby"] .room-code').innerText=e}function da(){console.log("render game");const{state:e}=Hn(r,"game.round")||"";"winner"!==e?(r.game||(r.initial_markup||(r.initial_markup=document.querySelector('[data-screen="game"]').innerHTML),ya()),Vo(),Go()&&(console.log("update round"),fa())):pa()}function fa(){console.log("update round");const{hider:e,seeker:t}=Hn(r,"game.round")||{};console.log("hider:",e),console.log("seeker:",t);const{playerList:n}=r||{};console.log("playerList:",n),r.dom.$broadcast.innerHTML=`<div>${n[t].playerName} is seeking</div>`,r.dom.$narrative.innerHTML=`<div>${n[e].playerName} has treasure hidden here</div>`,Jo(Ko(e))}function pa(){console.log("render end game"),r.dom.$broadcast.classList.add("hide"),r.dom.$narrative.innerHTML="tally up your treasure"}async function ya(){document.querySelector('[data-screen="game"]').innerHTML=r.initial_markup;const e={};r.dom=e,e.$crates=document.querySelector('[data-screen="game"] .crates'),e.$broadcast=document.querySelector('[data-screen="game"] .broadcast'),e.$narrative=document.querySelector('[data-screen="game"] .narrative'),e.$treasureWrapper=document.querySelector('[data-screen="game"] .treasure-wrapper'),e.$broadcast.innerHTML="Select crates to hide your treasure",e.$treasureWrapper.innerHTML='<div class="treasure"></div><div class="treasure"></div><div class="treasure"></div>',Jo(Wo())}const ga={lobby:ia,game:da};async function ha({playerType:e,screen:n}){t();const r={host:ca,player:ga};await r[e][n]&&r[e][n](),i(n)}function va(e){console.log("on player list updated",e),r.playerList=e.exists()?e.toJSON():{},ha({playerType:"player",screen:"lobby"})}const ma=e=>{t();const n=e.exists()?e.toJSON():"";n&&ha({playerType:"player",screen:n})};function ba(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function _a(e,t,n={}){(n={path:"/",...n}).expires instanceof Date&&(n.expires=n.expires.toUTCString());let r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(let e in n){r+="; "+e;let t=n[e];!0!==t&&(r+="="+t)}document.cookie=r}function ja(e){console.log("on game updated",e),e.exists()?(console.log("snapshot does exist",e.exists()),r.game=e.toJSON()||{},ha({playerType:"player",screen:"game"})):console.log("snapshot does not exist",e.exists())}async function wa({code:e}){console.log("new player");const t=window.firebase.database().ref("rooms/"+e);let n="";const o=Oa();_a("playerName",o),await t.child("players").push({playerName:o}).then(e=>{console.log("player set"),n=e.getKey(),t.child("players").child(n).onDisconnect().remove(),console.log("display lobby"),i("lobby")});const a={code:e,listen:Sa,playerKey:n,playerList:"",ref:t};return Object.assign(r,a),{code:e,listen:Sa,playerKey:n,playerList:"",ref:t}}function Oa(){return console.log("get player name"),document.querySelector('[data-input="player-name"]').value||"guest"}function Sa(){console.log("listening");const{ref:e}=r;e.child("players").on("value",va),e.child("screen").on("value",ma),e.child("game").on("value",ja)}let La=!0;const xa=()=>(t(),document.querySelector('[data-input="room-code"]').value.toLowerCase()),$a=async()=>{if(!La)return;const{player:e}=window.app;if(e)return;La=!1;const t=xa(),n=window.firebase.database().ref("rooms/"+t);let o=!1;await n.once("value").then(e=>{const{screen:t}=e.toJSON()||{};"lobby"===t?o=!0:La=!0}),o&&(document.querySelector('[data-group="host"]').remove(),await wa({code:t}),r.listen())},Ta=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];function ka(){const e=[];for(let t=0;t<4;t++)e[t]=Aa(Ta);return e.join("")}function Aa(e){return e[Math.floor(Math.random()*e.length)]}function qa(e){console.log("on player list updated",e),r.playerList=e.exists()?e.toJSON():{},ha({playerType:"host",screen:"lobby"})}function Ma(e){console.log("on game updated",e),e.exists()?(console.log("snapshot does exist",e.exists()),r.game=e.toJSON()||{},ha({playerType:"host",screen:"game"})):console.log("snapshot does not exist",e.exists())}async function za(){console.log("new host");const e=ka(),t=window.firebase.database().ref("rooms/"+e);console.log("ref:",t);await t.onDisconnect().remove(),console.log("ref set lobby"),await t.set({screen:"lobby"});const n={code:e,listen:Na,playerList:"",playerType:"host",ref:t};Object.assign(r,n)}function Na(){console.log("listening");const{ref:e}=r;e.child("players").on("value",qa),e.child("game").on("value",Ma)}let Ea=!0;async function Ha(){const{host:e}=window.app;e||Ea&&(Ea=!1,document.querySelector('[data-group="player"]').remove(),await za(),r.listen(),ha({playerType:"host",screen:"lobby"}))}async function Pa(e){const t=o();await t.update({screen:e}).then(()=>{ha({screen:e,playerType:"host"})})}function Ca(){console.log("race again"),Pa("lobby")}async function Ra(e){"Select crates to hide your treasure"===document.querySelector('[data-screen="game"] .game-info .broadcast').innerText&&Ia(e);const t=Hn(r,"game.round.seeker")||"",n=r.playerKey||"";t&&t===n&&Ua(e)}function Da(){console.log("hasTreasure()");const{hider:e}=Hn(r,"game.round")||{},{indexes:t,guesses:n=""}=Hn(r,"game.players."+e)||{};console.log("hider:",e),console.log("indexes:",t),console.log("guesses:",n);return To(t.split(","),n.split(",")).length<3?(console.log("has treasure"),!0):(console.log("does not have treasure"),!1)}async function Ua(e){if(!Da())return void console.log("no treasure left");const{round:t}=r.game||{};if(!t.guesses)return;console.log("Guessing a crate",e);const n=e.target.dataset.index,{hider:a,seeker:s}=Hn(r,"game.round")||{},c=Hn(r,"game.players."+a)||{},i=Hn(r,"game.players."+s)||{},u=c.guesses?c.guesses.split(","):[];if(u.includes(n))return void console.log("crate already opened");u.push(n);const l=o();let d={};d[`game/players/${a}/guesses`]=u.join(","),d["game/round/guesses"]=t.guesses-=1,console.log("indexes:",c.indexes),console.log("selectedIndex:",n),c.indexes.split(",").includes(n)&&(console.log("a treasure was found"),d[`game/players/${a}/treasure`]=c.treasure-=1,d[`game/players/${s}/treasure`]=i.treasure+=1),await l.update(d).then(()=>{console.log("guesses remaining",t.guesses)})}function Ia(e){console.log("hiding a treasure");const t=e.target,n=document.querySelector('[data-screen="game"] .treasure-wrapper'),r=document.querySelector('[data-screen="game"] .commit-wrapper');if(t.classList.contains("selected"))return t.classList.remove("selected"),n.insertAdjacentHTML("beforeend",'<div class="treasure"></div>'),void r.classList.add("hide");const o=document.querySelectorAll('[data-screen="game"] .treasure-wrapper .treasure');o.length&&(1===o.length&&r.classList.remove("hide"),t.classList.add("selected"),n.removeChild(n.lastChild))}async function Fa(){console.log("start game");const{screen:e}=r;"game"!==e&&Pa("game")}const Ba={commit:s,joinGame:$a,newGame:Ha,playAgain:Ca,selectCrate:Ra,startGame:Fa};function Ga(e){console.log("clicked:",e);const t=e.target.dataset.action||"";Ba[t]&&Ba[t](e)}const Ja=()=>{t(),document.addEventListener("click",Ga,!1)},Wa=()=>{t();const e=ba("playerName");e&&(document.querySelector('[data-input="player-name"]').value=e)},Ka=()=>{t(),window.app=r,Wa(),Ja()};window.addEventListener("load",Ka)}()</script><!-- The core Firebase JS SDK is always required and must be listed first --><script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-database.js"></script><!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries --><script>var firebaseConfig={apiKey:"AIzaSyBCf6ie1SYSt1u3RNSuwOc2N4Ld-m3C6zA",authDomain:"climb-00.firebaseapp.com",databaseURL:"https://climb-00.firebaseio.com",projectId:"climb-00",storageBucket:"climb-00.appspot.com",messagingSenderId:"735552551317",appId:"1:735552551317:web:0b3bbefcc0b17337289e9c"};firebase.initializeApp(firebaseConfig)</script></body></html>