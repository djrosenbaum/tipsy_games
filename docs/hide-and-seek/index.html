<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="Hide and seek"><!-- <meta property="og:title" content="Hide and Seek"> --><!-- <meta property="og:description" content="My description"> --><!-- <meta property="og:type" content="website"> --><!-- <meta property="og:image" content="https://via.placeholder.com/500"> --><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Monoton&display=fallback" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,400;0,700;1,900&display=fallback" rel="stylesheet"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><!-- <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png"> --><!-- <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png"> --><title>Hide and Seek</title><style>a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}body{line-height:1}body{background-color:#fff;color:#333;font-family:Lato,Arial,Helvetica,sans-serif}a{color:inherit;text-decoration:none}a,button,input{font-family:Lato,Arial,Helvetica,sans-serif}button{background-color:#222;border:none;border-radius:2px;color:#fff;cursor:pointer;font-size:21px;padding:15px;width:100%}button:active{border:1px solid #333;color:#333;outline:1px solid #333}button:focus{border:1px solid #333;color:#333;outline:1px solid #333}input{box-sizing:border-box;font-family:Lato,Arial,Helvetica,sans-serif;font-size:30px;font-weight:400;margin-bottom:40px;width:100%}label{font-family:Lato,Arial,Helvetica,sans-serif;font-size:21px;font-weight:200}.hidden{display:none!important}.hide{display:none!important}.invisible{visibility:hidden}.spacer{border-bottom:1px dashed #777;margin:10px 0}.page-wrapper{margin:0 auto;max-width:1000px;padding:10px 30px}.button-wrapper{text-align:center;padding:10px 0}.container{padding-bottom:30px}.room-code{text-transform:uppercase}.bold{font-weight:700}.bold.link{font-weight:700;padding:10px 0}.reflect{-webkit-box-reflect:below 0 -webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(70%,transparent),to(rgba(250,250,250,.1)))}.header{width:100vw;text-align:center;background-color:#222;color:#fff;font-weight:200;padding:10px 0}.header h1{color:#fff;font-family:Monoton,cursive;font-size:24px;font-weight:400;letter-spacing:2px;text-shadow:1px 2px #000;text-transform:uppercase}[data-screen=landing]{max-width:420px;margin:0 auto}[data-screen=landing] [data-input=room-code]{text-transform:uppercase}[data-screen=landing] button{color:#ff0;font-family:Monoton,cursive;font-weight:400;letter-spacing:2px;text-shadow:1px 2px #000;text-transform:uppercase}[data-screen=landing] .game-name{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=lobby]{font-size:20px;max-width:420px;margin:0 auto}[data-screen=lobby] button{max-width:250px}[data-screen=lobby] .game-info{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=lobby] .game-name{padding-bottom:10px}[data-group=host] [data-screen=lobby]{max-width:1000px;margin:0 auto}[data-group=host] [data-screen=lobby] .crate-wrapper{position:relative;height:100px;margin-bottom:40px}[data-group=host] [data-screen=lobby] .crate{background-image:url(images/crate.svg);background-size:cover;height:100px;width:100px}[data-group=host] [data-screen=lobby] .player-name{position:absolute;position:absolute;bottom:10px;left:110px}[data-group=host] [data-screen=lobby] .waiting{text-align:center;padding:30px 0;text-transform:uppercase}[data-group=player] [data-screen=lobby] .section-title{text-align:center;border-bottom:1px dotted #333}[data-group=player] [data-screen=lobby] .player-list .player{padding:10px;border-bottom:1px dotted #ccc}[data-group=player] [data-screen=lobby] .player-list .player .crate{display:inline-block;width:30px;height:30px;vertical-align:middle;background-image:url(images/crate.svg);background-size:cover}[data-group=player] [data-screen=lobby] .player-list .player .player-name{padding-left:10px}[data-group=player] [data-screen=lobby] .menu{margin-bottom:20px}[data-group=player] [data-screen=lobby] .menu table{margin:0 auto;border-collapse:collapse}[data-group=player] [data-screen=lobby] .menu td{width:100px;height:54px;border:1px solid #ccc}[data-group=player] [data-screen=lobby] .menu button{width:100%;height:100%;background-color:transparent;background-image:url(images/horse_still_frame.png);background-size:contain;background-repeat:no-repeat;background-position:center}.dice{padding:4px;background-color:#333;width:104px;height:104px;border-radius:10%;margin-right:10px}.dot{display:block;width:24px;height:24px;border-radius:50%;background-color:#fff}.first-face{display:flex;justify-content:center;align-items:center}.second-face{display:flex;justify-content:space-between}.second-face .dot:nth-of-type(2){align-self:flex-end}.third-face{display:flex;justify-content:space-between}.third-face .dot:nth-of-type(1){align-self:flex-end}.third-face .dot:nth-of-type(2){align-self:center}.fifth-face,.fourth-face,.sixth-face{display:flex;justify-content:space-between}.fifth-face .column,.fourth-face .column,.sixth-face .column{display:flex;flex-direction:column;justify-content:space-between}.fifth-face .column:nth-of-type(2){justify-content:center}[data-screen=game]{max-width:1000px;margin:0 auto}[data-screen=game] .game-info{text-align:center;padding:10px;border:1px dashed #ccc;margin-bottom:20px;font-weight:400;font-size:18px}[data-screen=game] .game-name{padding-bottom:10px}[data-screen=game] .crates{width:300px;margin:0 auto;margin-bottom:20px}[data-screen=game] .crates [data-crates]{display:grid;grid-template-columns:repeat(5,1fr);justify-items:center;justify-content:center;grid-template-rows:repeat(5,60px);align-items:center}[data-screen=game] .crate{background-image:url(images/crate.svg);width:40px;height:40px;background-size:cover}[data-screen=game] .crate.selected{border:3px solid gold}[data-screen=game] .crate.open{opacity:.3}[data-screen=game] .play-again{padding-top:20px;text-align:center}[data-screen=game] .play-again button{max-width:200px;text-transform:capitalize}[data-screen=game] .player-list{border-top:1px dashed #999;margin:0 auto;padding-top:30px;width:320px}[data-screen=game] .player-list .player{padding:10px;border-bottom:1px dotted #ccc}[data-screen=game] .player-list .player .player-name{font-weight:700}[data-group=player] [data-screen=game] .treasure-wrapper{display:grid;grid-template-columns:repeat(5,1fr);justify-items:center;justify-content:center;grid-template-rows:repeat(1,60px);align-items:center;width:300px;margin:0 auto}[data-screen=game] .treasure{background-image:url(images/gold.svg);width:40px;height:40px;background-size:cover}[data-screen=game] .player-list .treasure{margin-left:15px;display:inline-block;vertical-align:middle}[data-screen=game] .narrative{width:320px;margin:0 auto;text-align:center;line-height:24px}[data-group=player] [data-screen=game] .commit-wrapper{text-align:center;margin-top:30px;margin-bottom:30px}[data-group=player] [data-screen=game] .commit-wrapper button{color:gold;width:300px}</style></head><body><div class="header"><h1>tipsy.games</h1></div><div class="page-wrapper"><div class="container" data-screen="landing"><div class="game-name">Hide and Seek</div><div><label>Room Code</label><input data-input="room-code" type="text" placeholder="AAAA"></div><div><label>Player Name</label><input data-input="player-name" type="text" placeholder="guest"></div><div class="button-wrapper"><button data-action="joinGame">Join Game</button></div><div class="spacer"></div><div class="button-wrapper"><button data-action="newGame">New Game</button></div></div><div data-group="host"><div class="container hidden" data-screen="lobby"><div data-group="host"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="room-code bold"></div></div></div><div class="crates"></div><div class="waiting">waiting for players to join</div><div class="start-game-wrapper"><div class="button-wrapper hide"><button data-action="startGame">Start Game</button></div></div></div></div><div class="container hidden" data-screen="game"><div data-group="host"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="broadcast bold hide">Start Hiding</div></div></div><div class="crates"></div><div class="narrative"></div><div class="player-list"></div><div class="play-again hide"><button data-action="playAgain">play again</button></div></div></div></div><div data-group="player"><div class="container hidden" data-screen="lobby"><div data-group="player"><div class="game-info"><div class="game-name">Hide and Seek</div><div class="room-code bold"></div></div><div><div class="section-title">Player List</div><div class="player-list"></div></div></div></div><div class="container hidden" data-screen="game"><div data-group="player"><div><div class="game-info"><div class="game-name">Hide and Seek</div><div class="broadcast bold"></div></div></div><div class="treasure-wrapper"></div><div class="crates"></div><div class="narrative"></div><div class="commit-wrapper hide"><button data-action="commit">commit</button></div><div class="player-list"></div></div></div></div></div><script>!function(){"use strict";const e=[],t=()=>{e.push(...arguments)},n=()=>{window.console.log(e.join("\n"))},r={displayLog:n};function o(){return r.ref}let a=!0;async function s(){if(console.log("commit treasure"),!a)return;a=!1;document.querySelector('[data-screen="game"] .game-info .broadcast').innerHTML="Your treasure is hidden";document.querySelector('[data-screen="game"] .treasure-wrapper').classList.add("hide");document.querySelector('[data-screen="game"] .commit-wrapper').classList.add("hide");const e=c();console.log("indexes",e);const t=o(),{playerKey:n}=r;await t.child("game/players/"+n).update({indexes:e,treasure:3}).then(()=>{console.log("indexes are set:",e),a=!0})}function c(){const e=document.querySelectorAll(".crate.selected"),t=[];return e.forEach(e=>{t.push(e.dataset.index)}),t.join(",")}function l(e){console.log("display screen:",e),document.querySelectorAll("[data-screen]").forEach(e=>{e.classList.add("hidden")}),document.querySelector(`[data-screen="${e}"]`).classList.remove("hidden"),window.app.screen=e}function i(){console.log("render the lobby");const{code:e,playerList:t}=r;e&&p(e),d(t),u(t,2),console.log("beginning to render the lobby")}function u(e,t){const n=Object.keys(e).length,r=document.querySelector('[data-screen="lobby"] button[data-action="startGame"]').parentNode;n<t?r.classList.add("hide"):r.classList.remove("hide")}function d(e){console.log("update player list",e);let t=Object.keys(e).map(t=>{const{playerName:n}=e[t];return`<div class="crate-wrapper"><div class="crate reflect"></div><div class="player-name">${n}</div></div>`}).join("");document.querySelector('[data-screen="lobby"] .crates').innerHTML=t}function p(e){document.querySelector('[data-screen="lobby"] .room-code').innerText=e}var y="object"==typeof global&&global&&global.Object===Object&&global,g="object"==typeof self&&self&&self.Object===Object&&self,f=y||g||Function("return this")(),h=f.Symbol,m=Object.prototype,v=m.hasOwnProperty,b=m.toString,_=h?h.toStringTag:void 0;function j(e){var t=v.call(e,_),n=e[_];try{e[_]=void 0;var r=!0}catch(e){}var o=b.call(e);return r&&(t?e[_]=n:delete e[_]),o}var w=Object.prototype,S=w.toString;function L(e){return S.call(e)}var x="[object Null]",O="[object Undefined]",T=h?h.toStringTag:void 0;function $(e){return null==e?void 0===e?O:x:T&&T in Object(e)?j(e):L(e)}function k(e){return null!=e&&"object"==typeof e}var A="[object Symbol]";function q(e){return"symbol"==typeof e||k(e)&&$(e)==A}function N(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}var M=Array.isArray,H=1/0,C=h?h.prototype:void 0,E=C?C.toString:void 0;function P(e){if("string"==typeof e)return e;if(M(e))return N(e,P)+"";if(q(e))return E?E.call(e):"";var t=e+"";return"0"==t&&1/e==-H?"-0":t}function R(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function z(e){return e}var F="[object AsyncFunction]",U="[object Function]",I="[object GeneratorFunction]",D="[object Proxy]";function G(e){if(!R(e))return!1;var t=$(e);return t==U||t==I||t==F||t==D}var J,B=f["__core-js_shared__"],K=(J=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+J:"";function W(e){return!!K&&K in e}var V=Function.prototype,Y=V.toString;function Q(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var X=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,ee=Function.prototype,te=Object.prototype,ne=ee.toString,re=te.hasOwnProperty,oe=RegExp("^"+ne.call(re).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ae(e){return!(!R(e)||W(e))&&(G(e)?oe:Z).test(Q(e))}function se(e,t){return null==e?void 0:e[t]}function ce(e,t){var n=se(e,t);return ae(n)?n:void 0}function le(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function ie(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var ue=800,de=16,pe=Date.now;function ye(e){var t=0,n=0;return function(){var r=pe(),o=de-(r-n);if(n=r,o>0){if(++t>=ue)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function ge(e){return function(){return e}}var fe=function(){try{var e=ce(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),he=fe?function(e,t){return fe(e,"toString",{configurable:!0,enumerable:!1,value:ge(t),writable:!0})}:z,me=ye(he);function ve(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}function be(e){return e!=e}function _e(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function je(e,t,n){return t==t?_e(e,t,n):ve(e,be,n)}function we(e,t){return!!(null==e?0:e.length)&&je(e,t,0)>-1}var Se=9007199254740991,Le=/^(?:0|[1-9]\d*)$/;function xe(e,t){var n=typeof e;return!!(t=null==t?Se:t)&&("number"==n||"symbol"!=n&&Le.test(e))&&e>-1&&e%1==0&&e<t}function Oe(e,t){return e===t||e!=e&&t!=t}var Te=Math.max;function $e(e,t,n){return t=Te(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=Te(r.length-t,0),s=Array(a);++o<a;)s[o]=r[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=r[o];return c[t]=n(s),le(e,this,c)}}function ke(e,t){return me($e(e,t,z),e+"")}var Ae=9007199254740991;function qe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ae}function Ne(e){return null!=e&&qe(e.length)&&!G(e)}var Me=Object.prototype;function He(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Me)}function Ce(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ee="[object Arguments]";function Pe(e){return k(e)&&$(e)==Ee}var Re=Object.prototype,ze=Re.hasOwnProperty,Fe=Re.propertyIsEnumerable,Ue=Pe(function(){return arguments}())?Pe:function(e){return k(e)&&ze.call(e,"callee")&&!Fe.call(e,"callee")};function Ie(){return!1}var De="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ge=De&&"object"==typeof module&&module&&!module.nodeType&&module,Je=Ge&&Ge.exports===De,Be=Je?f.Buffer:void 0,Ke=Be?Be.isBuffer:void 0,We=Ke||Ie,Ve="[object Arguments]",Ye="[object Array]",Qe="[object Boolean]",Xe="[object Date]",Ze="[object Error]",et="[object Function]",tt="[object Map]",nt="[object Number]",rt="[object Object]",ot="[object RegExp]",at="[object Set]",st="[object String]",ct="[object WeakMap]",lt="[object ArrayBuffer]",it="[object DataView]",ut="[object Float32Array]",dt="[object Float64Array]",pt="[object Int8Array]",yt="[object Int16Array]",gt="[object Int32Array]",ft="[object Uint8Array]",ht="[object Uint8ClampedArray]",mt="[object Uint16Array]",vt="[object Uint32Array]",bt={};function _t(e){return k(e)&&qe(e.length)&&!!bt[$(e)]}function jt(e){return function(t){return e(t)}}bt[ut]=bt[dt]=bt[pt]=bt[yt]=bt[gt]=bt[ft]=bt[ht]=bt[mt]=bt[vt]=!0,bt[Ve]=bt[Ye]=bt[lt]=bt[Qe]=bt[it]=bt[Xe]=bt[Ze]=bt[et]=bt[tt]=bt[nt]=bt[rt]=bt[ot]=bt[at]=bt[st]=bt[ct]=!1;var wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,St=wt&&"object"==typeof module&&module&&!module.nodeType&&module,Lt=St&&St.exports===wt,xt=Lt&&y.process,Ot=function(){try{var e=St&&St.require&&St.require("util").types;return e||xt&&xt.binding&&xt.binding("util")}catch(e){}}(),Tt=Ot&&Ot.isTypedArray,$t=Tt?jt(Tt):_t,kt=Object.prototype,At=kt.hasOwnProperty;function qt(e,t){var n=M(e),r=!n&&Ue(e),o=!n&&!r&&We(e),a=!n&&!r&&!o&&$t(e),s=n||r||o||a,c=s?Ce(e.length,String):[],l=c.length;for(var i in e)!t&&!At.call(e,i)||s&&("length"==i||o&&("offset"==i||"parent"==i)||a&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||xe(i,l))||c.push(i);return c}function Nt(e,t){return function(n){return e(t(n))}}var Mt=Nt(Object.keys,Object),Ht=Object.prototype,Ct=Ht.hasOwnProperty;function Et(e){if(!He(e))return Mt(e);var t=[];for(var n in Object(e))Ct.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Pt(e){return Ne(e)?qt(e):Et(e)}var Rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zt=/^\w*$/;function Ft(e,t){if(M(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!q(e))||(zt.test(e)||!Rt.test(e)||null!=t&&e in Object(t))}var Ut=ce(Object,"create");function It(){this.__data__=Ut?Ut(null):{},this.size=0}function Dt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Gt="__lodash_hash_undefined__",Jt=Object.prototype,Bt=Jt.hasOwnProperty;function Kt(e){var t=this.__data__;if(Ut){var n=t[e];return n===Gt?void 0:n}return Bt.call(t,e)?t[e]:void 0}var Wt=Object.prototype,Vt=Wt.hasOwnProperty;function Yt(e){var t=this.__data__;return Ut?void 0!==t[e]:Vt.call(t,e)}var Qt="__lodash_hash_undefined__";function Xt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ut&&void 0===t?Qt:t,this}function Zt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function en(){this.__data__=[],this.size=0}function tn(e,t){for(var n=e.length;n--;)if(Oe(e[n][0],t))return n;return-1}Zt.prototype.clear=It,Zt.prototype.delete=Dt,Zt.prototype.get=Kt,Zt.prototype.has=Yt,Zt.prototype.set=Xt;var nn=Array.prototype,rn=nn.splice;function on(e){var t=this.__data__,n=tn(t,e);return!(n<0)&&(n==t.length-1?t.pop():rn.call(t,n,1),--this.size,!0)}function an(e){var t=this.__data__,n=tn(t,e);return n<0?void 0:t[n][1]}function sn(e){return tn(this.__data__,e)>-1}function cn(e,t){var n=this.__data__,r=tn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function ln(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ln.prototype.clear=en,ln.prototype.delete=on,ln.prototype.get=an,ln.prototype.has=sn,ln.prototype.set=cn;var un=ce(f,"Map");function dn(){this.size=0,this.__data__={hash:new Zt,map:new(un||ln),string:new Zt}}function pn(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function yn(e,t){var n=e.__data__;return pn(t)?n["string"==typeof t?"string":"hash"]:n.map}function gn(e){var t=yn(this,e).delete(e);return this.size-=t?1:0,t}function fn(e){return yn(this,e).get(e)}function hn(e){return yn(this,e).has(e)}function mn(e,t){var n=yn(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}vn.prototype.clear=dn,vn.prototype.delete=gn,vn.prototype.get=fn,vn.prototype.has=hn,vn.prototype.set=mn;var bn="Expected a function";function _n(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(bn);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=e.apply(this,r);return n.cache=a.set(o,s)||a,s};return n.cache=new(_n.Cache||vn),n}_n.Cache=vn;var jn=500;function wn(e){var t=_n(e,(function(e){return n.size===jn&&n.clear(),e})),n=t.cache;return t}var Sn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ln=/\\(\\)?/g,xn=wn((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Sn,(function(e,n,r,o){t.push(r?o.replace(Ln,"$1"):n||e)})),t}));function On(e){return null==e?"":P(e)}function Tn(e,t){return M(e)?e:Ft(e,t)?[e]:xn(On(e))}var $n=1/0;function kn(e){if("string"==typeof e||q(e))return e;var t=e+"";return"0"==t&&1/e==-$n?"-0":t}function An(e,t){for(var n=0,r=(t=Tn(t,e)).length;null!=e&&n<r;)e=e[kn(t[n++])];return n&&n==r?e:void 0}function qn(e,t,n){var r=null==e?void 0:An(e,t);return void 0===r?n:r}var Nn="__lodash_hash_undefined__";function Mn(e){return this.__data__.set(e,Nn),this}function Hn(e){return this.__data__.has(e)}function Cn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new vn;++t<n;)this.add(e[t])}function En(e,t){return e.has(t)}function Pn(e){return k(e)&&Ne(e)}function Rn(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function zn(e,t){return N(t,(function(t){return e[t]}))}function Fn(e){return null==e?[]:zn(e,Pt(e))}Cn.prototype.add=Cn.prototype.push=Mn,Cn.prototype.has=Hn;var Un=Math.min;function In(e,t,n){for(var r=n?Rn:we,o=e[0].length,a=e.length,s=a,c=Array(a),l=1/0,i=[];s--;){var u=e[s];s&&t&&(u=N(u,jt(t))),l=Un(u.length,l),c[s]=!n&&(t||o>=120&&u.length>=120)?new Cn(s&&u):void 0}u=e[0];var d=-1,p=c[0];e:for(;++d<o&&i.length<l;){var y=u[d],g=t?t(y):y;if(y=n||0!==y?y:0,!(p?En(p,g):r(i,g,n))){for(s=a;--s;){var f=c[s];if(!(f?En(f,g):r(e[s],g,n)))continue e}p&&p.push(g),i.push(y)}}return i}function Dn(e){return Pn(e)?e:[]}var Gn=ke((function(e){var t=N(e,Dn);return t.length&&t[0]===e[0]?In(t):[]})),Jn=Math.floor,Bn=Math.random;function Kn(e,t){return e+Jn(Bn()*(t-e+1))}function Wn(e,t){var n=-1,r=e.length,o=r-1;for(t=void 0===t?r:t;++n<t;){var a=Kn(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}function Vn(e){return Wn(ie(e))}function Yn(e){return Wn(Fn(e))}function Qn(e){return(M(e)?Vn:Yn)(e)}let Xn=0;function Zn(){console.log("render game");const{state:e}=qn(window,"app.game.round")||"";return"winner"===e?(rr(),void tr()):window.app.game?(fr(),void(nr()?(console.log("can update round"),rr()):(console.log("can not update round"),console.log("isReadyToStartRound:",cr()),cr()&&(console.log("ready to start the round"),lr())))):(r.initial_markup||(r.initial_markup=document.querySelector('[data-screen="game"]').innerHTML),pr(),void fr())}function er(){const{hider:e}=qn(window,"app.game.round")||{},{indexes:t,guesses:n=""}=qn(r,"game.players."+e)||{};return Gn(t.split(","),n.split(",")).length<3?(console.log("has treasure"),!0):(console.log("does not have treasure"),!1)}function tr(){console.log("render end game");const{dom:e}=r;e.$broadcast.innerHTML="tally up your treasure",e.$narrative.classList.add("hide"),e.$playAgain.classList.remove("hide")}function nr(){return!!qn(r,"game.round.roundNumber")}function rr(){if(console.log("update round"),!er())return console.log("no treasure"),void or();const{hider:e,seeker:t,roundNumber:n,guesses:o}=qn(r,"game.round")||{};console.log("hider:",e),console.log("seeker:",t),console.log("roundNumber:",n),console.log("guesses:",o);const{playerList:a}=r||{};console.log("playerList:",a);const{dom:s}=r;s.$broadcast.innerHTML=`<div>${a[t].playerName} is seeking</div>`,s.$narrative.innerHTML=`<div>${a[e].playerName} has treasure hidden here</div>`,gr(sr(e)),o||(console.log("Out of guesses, rotate to next player"),or())}async function or(){console.log("END TURN");const{round:e,players:t}=r.game||{};let n=e.seekers.split(",");1===n.length?n=Qn(Object.keys(t)):n.shift();const a=n[0],s=Object.keys(t).length;let c=dr();if(1===c.length)return console.log("all treasure found"),void ar();const l=c.filter(e=>e!==a);console.log("total players: ",s),console.log("remaining boards: ",l);const i={guesses:3,hider:Qn(l)[0],roundNumber:e.roundNumber,seeker:a,seekers:n.join(",")},u=o();await u.child("game/round").update(i).then(()=>{console.log("updated the round")})}async function ar(){console.log("BROADCAST WINNER");const e=o();await e.child("game/round").update({state:"winner"}).then(()=>{console.log("display the leaderboard")})}function sr(e){console.log("getGridArrayFromPlayer",e);const t=yr(),{indexes:n,guesses:o}=qn(r,"game.players."+e)||{};if(o){const e=n.split(",");console.log("indexesArray",e),o.split(",").forEach(n=>{const r=Number(n);console.log("guess index:",r),t[r]=1,e.includes(r.toString())&&(t[r]=2)})}return t}function cr(){return!!r.game&&Object.keys(r.playerList).length===Object.keys(r.game.players).length}async function lr(){console.log("START ROUND");const e=ur();if(Xn===e)return;Xn=e;const t=dr();console.log("remaining boards:",t);const n=ir();console.log("seekers:",n);const r=n[0];console.log("seeker:",r);const a=Qn(t.filter(e=>e!==r))[0];console.log("hider:",r);const s={guesses:3,hider:a,roundNumber:e,seeker:r,seekers:n.join(",")},c=o();await c.child("game/round").update(s).then(()=>{console.log("started the round")})}function ir(){const{players:e}=r.game||{};return Qn(Object.keys(e))}function ur(){return qn(r,"game.round.roundNumber")||1}function dr(){console.log("get remaining boards");const{players:e}=r.game||{},t=[];for(const n in e){const{guesses:r="",indexes:o=""}=e[n],a=r.split(","),s=o.split(",");Gn(s,a).length<3?(console.log("treasure remains",n),t.push(n)):console.log("no treasure remains",n)}return t}async function pr(){console.log("newGame()"),document.querySelector('[data-screen="game"]').innerHTML=r.initial_markup;const e={};r.dom=e,e.$crates=document.querySelector('[data-screen="game"] .crates'),e.$broadcast=document.querySelector('[data-screen="game"] .broadcast'),e.$narrative=document.querySelector('[data-screen="game"] .narrative'),e.$playAgain=document.querySelector('[data-screen="game"] .play-again'),e.$broadcast.innerHTML="Time to hide your treasure",e.$broadcast.classList.remove("hide"),gr(yr())}function yr(){let e=[];return e.length=25,e.fill(0),e}function gr(e){let t=e.map((e,t)=>0===e?`<div class="crate" data-action="selectCrate" data-index="${t}"></div>`:1===e?'<div class="crate open"></div>':2===e?'<div class="treasure"></div>':void 0).join("");r.dom.$crates.innerHTML=`<div data-crates="default">${t}</div>`}function fr(){const{playerList:e}=r||{};console.log("update player list",e);let t=Object.keys(e).map(e=>{const{playerName:t}=qn(r,"playerList."+e)||"undefined",{treasure:n}=qn(r,"game.players."+e)||0;return`<div class="player" data-key=${e}><div class="player-name">${t}</div>${'<div class="treasure"></div>'.repeat(n)}</div>`}).join("");r.dom.$playerList=document.querySelector('[data-screen="game"] .player-list'),r.dom.$playerList.innerHTML=t}const hr={game:Zn,lobby:i};function mr(){console.log("render the lobby");const{code:e,playerList:t}=r;e&&br(e),t&&vr(t),console.log("beginning to render the lobby")}function vr(e){console.log("update player list",e);document.querySelector('[data-screen="lobby"] .player-list').innerHTML=Object.keys(e).map(t=>`<div class="player"><div class="crate"></div><span class="player-name">${e[t].playerName}</span></div>`).join("")}function br(e){document.querySelector('[data-screen="lobby"] .room-code').innerText=e}let _r,jr,wr,Sr,Lr="";const xr=()=>{console.log("render game");const{state:e}=qn(r,"game.round")||"";"winner"!==e?(r.game||(Lr||(Lr=document.querySelector('[data-screen="game"]').innerHTML),kr()),Mr(),$r()&&(console.log("update round"),Or())):Tr()};function Or(){console.log("update round");const{hider:e,seeker:t,roundNumber:n}=qn(r,"game.round")||{};console.log("hider:",e),console.log("seeker:",t),console.log("roundNumber:",n);const{playerList:o}=r||{};console.log("playerList:",o),jr.innerHTML=`<div>${o[t].playerName} is seeking</div>`,wr.innerHTML=`<div>${o[e].playerName} has treasure hidden here</div>`,Ar(Nr(e))}function Tr(){console.log("render end game"),jr.classList.add("hide"),wr.innerHTML="tally up your treasure"}function $r(){return!!qn(r,"game.round.roundNumber")}function kr(){console.log("new game"),document.querySelector('[data-screen="game"]').innerHTML=Lr,_r=document.querySelector('[data-screen="game"] .crates'),jr=document.querySelector('[data-screen="game"] .broadcast'),wr=document.querySelector('[data-screen="game"] .narrative'),Sr=document.querySelector('[data-screen="game"] .treasure-wrapper'),jr.innerHTML="Select crates to hide your treasure",Sr.innerHTML='<div class="treasure"></div><div class="treasure"></div><div class="treasure"></div>',Ar(qr())}function Ar(e){let t=e.map((e,t)=>0===e?`<div class="crate" data-action="selectCrate" data-index="${t}"></div>`:1===e?'<div class="crate open"></div>':2===e?'<div class="treasure"></div>':void 0).join("");_r.innerHTML=`<div data-crates="default">${t}</div>`}function qr(){let e=[];return e.length=25,e.fill(0),e}function Nr(e){console.log("getGridArrayFromPlayer",e);const t=qr(),{indexes:n,guesses:o}=qn(r,"game.players."+e)||{};if(o){const e=n.split(",");console.log("indexesArray",e),o.split(",").forEach(n=>{const r=Number(n);console.log("guess index:",r),t[r]=1,e.includes(r.toString())&&(t[r]=2)})}return t}function Mr(){console.log("updatePlayerList");const{playerList:e}=r;console.log("update player list",e);let t=Object.keys(e).map(e=>{const{playerName:t}=qn(r,"playerList."+e)||"undefined",{treasure:n}=qn(r,"game.players."+e)||0;return`<div class="player" data-key=${e}><div class="player-name">${t}</div>${'<div class="treasure"></div>'.repeat(n)}</div>`}).join("");document.querySelector('[data-screen="game"] .player-list').innerHTML=t}const Hr={lobby:mr,game:xr};async function Cr({playerType:e,screen:n}){t();const r={host:hr,player:Hr};await r[e][n]&&r[e][n](),l(n)}function Er(e){console.log("on player list updated",e),r.playerList=e.exists()?e.toJSON():{},Cr({playerType:"player",screen:"lobby"})}const Pr=e=>{t();const n=e.exists()?e.toJSON():"";n&&Cr({playerType:"player",screen:n})};function Rr(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function zr(e,t,n={}){(n={path:"/",...n}).expires instanceof Date&&(n.expires=n.expires.toUTCString());let r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(let e in n){r+="; "+e;let t=n[e];!0!==t&&(r+="="+t)}document.cookie=r}function Fr(e){console.log("on game updated",e),e.exists()?(console.log("snapshot does exist",e.exists()),r.game=e.toJSON()||{},Cr({playerType:"player",screen:"game"})):console.log("snapshot does not exist",e.exists())}async function Ur({code:e}){console.log("new player");const t=window.firebase.database().ref("rooms/"+e);let n="";const o=Ir();zr("playerName",o),await t.child("players").push({playerName:o}).then(e=>{console.log("player set"),n=e.getKey(),t.child("players").child(n).onDisconnect().remove(),console.log("display lobby"),l("lobby")});const a={code:e,listen:Dr,playerKey:n,playerList:"",ref:t};return Object.assign(r,a),{code:e,listen:Dr,playerKey:n,playerList:"",ref:t}}function Ir(){return console.log("get player name"),document.querySelector('[data-input="player-name"]').value||"guest"}function Dr(){console.log("listening");const{ref:e}=r;e.child("players").on("value",Er),e.child("screen").on("value",Pr),e.child("game").on("value",Fr)}let Gr=!0;const Jr=()=>(t(),document.querySelector('[data-input="room-code"]').value.toLowerCase()),Br=async()=>{if(!Gr)return;const{player:e}=window.app;if(e)return;Gr=!1;const t=Jr(),n=window.firebase.database().ref("rooms/"+t);let o=!1;await n.once("value").then(e=>{const{screen:t}=e.toJSON()||{};"lobby"===t?o=!0:Gr=!0}),o&&(document.querySelector('[data-group="host"]').remove(),await Ur({code:t}),r.listen())},Kr=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];function Wr(){const e=[];for(let t=0;t<4;t++)e[t]=Vr(Kr);return e.join("")}function Vr(e){return e[Math.floor(Math.random()*e.length)]}function Yr(e){console.log("on player list updated",e),r.playerList=e.exists()?e.toJSON():{},Cr({playerType:"host",screen:"lobby"})}function Qr(e){console.log("on game updated",e),e.exists()?(console.log("snapshot does exist",e.exists()),r.game=e.toJSON()||{},Cr({playerType:"host",screen:"game"})):console.log("snapshot does not exist",e.exists())}async function Xr(){console.log("new host");const e=Wr(),t=window.firebase.database().ref("rooms/"+e);console.log("ref:",t);await t.onDisconnect().remove(),console.log("ref set lobby"),await t.set({screen:"lobby"});const n={code:e,listen:Zr,playerList:"",playerType:"host",ref:t};Object.assign(r,n)}function Zr(){console.log("listening");const{ref:e}=r;e.child("players").on("value",Yr),e.child("game").on("value",Qr)}let eo=!0;async function to(){const{host:e}=window.app;e||eo&&(eo=!1,document.querySelector('[data-group="player"]').remove(),await Xr(),r.listen(),Cr({playerType:"host",screen:"lobby"}))}async function no(e){const t=o();await t.update({screen:e}).then(()=>{Cr({screen:e,playerType:"host"})})}function ro(){console.log("race again"),no("lobby")}async function oo(e){"Select crates to hide your treasure"===document.querySelector('[data-screen="game"] .game-info .broadcast').innerText&&co(e);const t=qn(r,"game.round.seeker")||"",n=r.playerKey||"";t&&t===n&&so(e)}function ao(){console.log("hasTreasure()");const{hider:e}=qn(r,"game.round")||{},{indexes:t,guesses:n=""}=qn(r,"game.players."+e)||{};console.log("hider:",e),console.log("indexes:",t),console.log("guesses:",n);return Gn(t.split(","),n.split(",")).length<3?(console.log("has treasure"),!0):(console.log("does not have treasure"),!1)}async function so(e){if(!ao())return void console.log("no treasure left");const{round:t}=r.game||{};if(!t.guesses)return;console.log("Guessing a crate",e);const n=e.target.dataset.index,{hider:a,seeker:s}=qn(r,"game.round")||{},c=qn(r,"game.players."+a)||{},l=qn(r,"game.players."+s)||{},i=c.guesses?c.guesses.split(","):[];if(i.includes(n))return void console.log("crate already opened");i.push(n);const u=o();let d={};d[`game/players/${a}/guesses`]=i.join(","),d["game/round/guesses"]=t.guesses-=1,console.log("indexes:",c.indexes),console.log("selectedIndex:",n),c.indexes.split(",").includes(n)&&(console.log("a treasure was found"),d[`game/players/${a}/treasure`]=c.treasure-=1,d[`game/players/${s}/treasure`]=l.treasure+=1),await u.update(d).then(()=>{console.log("guesses remaining",t.guesses)})}function co(e){console.log("hiding a treasure");const t=e.target,n=document.querySelector('[data-screen="game"] .treasure-wrapper'),r=document.querySelector('[data-screen="game"] .commit-wrapper');if(t.classList.contains("selected"))return t.classList.remove("selected"),n.insertAdjacentHTML("beforeend",'<div class="treasure"></div>'),void r.classList.add("hide");const o=document.querySelectorAll('[data-screen="game"] .treasure-wrapper .treasure');o.length&&(1===o.length&&r.classList.remove("hide"),t.classList.add("selected"),n.removeChild(n.lastChild))}async function lo(){console.log("start game");const{screen:e}=r;"game"!==e&&no("game")}const io={commit:s,joinGame:Br,newGame:to,playAgain:ro,selectCrate:oo,startGame:lo};function uo(e){console.log("clicked:",e);const t=e.target.dataset.action||"";io[t]&&io[t](e)}const po=()=>{t(),document.addEventListener("click",uo,!1)},yo=()=>{t();const e=Rr("playerName");e&&(document.querySelector('[data-input="player-name"]').value=e)},go=()=>{t(),window.app=r,yo(),po()};window.addEventListener("load",go)}()</script><!-- The core Firebase JS SDK is always required and must be listed first --><script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-database.js"></script><!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries --><script>var firebaseConfig={apiKey:"AIzaSyBCf6ie1SYSt1u3RNSuwOc2N4Ld-m3C6zA",authDomain:"climb-00.firebaseapp.com",databaseURL:"https://climb-00.firebaseio.com",projectId:"climb-00",storageBucket:"climb-00.appspot.com",messagingSenderId:"735552551317",appId:"1:735552551317:web:0b3bbefcc0b17337289e9c"};firebase.initializeApp(firebaseConfig)</script></body></html>